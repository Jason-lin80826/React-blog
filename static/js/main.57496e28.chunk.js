(this.webpackJsonpblog=this.webpackJsonpblog||[]).push([[0],{153:function(e,t,n){},154:function(e,t,n){},234:function(e,t,n){"use strict";n.r(t);var s=n(0),a=n(24),c=n.n(a),r=(n(153),n(45)),i=(n(154),n(30)),o=n(23),l="token",j=function(e){localStorage.setItem(l,e)},b=function(){return localStorage.getItem(l)},d="https://student-json-api.lidemy.me",u=function(){var e=b();return fetch("".concat(d,"/me"),{headers:{authorization:"Bearer ".concat(e)}}).then((function(e){return e.json()}))},h=Object(s.createContext)(null),m=Object(s.createContext)(null),O=Object(s.createContext)(null),p=n(143),x=n(238),g=n(239),f=n(242),y=n(60),v=n(6);function C(e){var t=Object(s.useContext)(h).setUser,n=Object(s.useContext)(m).setIsLoading,a=e.handleOk,c=Object(o.g)();return Object(v.jsxs)(x.a,{name:"basic",labelCol:{span:5},wrapperCol:{span:16},initialValues:{remember:!0},onFinish:function(e){var s=e.username,r=e.password;n(!0),function(e,t){return fetch("".concat(d,"/login"),{method:"POST",headers:{"content-type":"application/json"},body:JSON.stringify({username:e,password:t})}).then((function(e){return e.json()}))}(s,r).then((function(e){if(0===e.ok)return n(!1),p.b.error("\u5e33\u865f\u5bc6\u78bc\u932f\u8aa4");j(e.token),u().then((function(e){1!==e.ok&&j(null),t(e.data),a(),c.push("/"),p.b.success("\u767b\u5165\u6210\u529f"),n(!1)}))}))},onFinishFailed:function(e){console.log("Failed:",e)},children:[Object(v.jsx)(x.a.Item,{label:"Username",name:"username",rules:[{required:!0,message:"Please input your username!"}],children:Object(v.jsx)(g.a,{})}),Object(v.jsx)(x.a.Item,{label:"Password",name:"password",rules:[{required:!0,message:"Please input your password!"}],children:Object(v.jsx)(g.a.Password,{})}),Object(v.jsx)(x.a.Item,{name:"remember",valuePropName:"checked",wrapperCol:{offset:5,span:16},children:Object(v.jsx)(f.a,{children:"Remember me"})}),Object(v.jsx)(x.a.Item,{wrapperCol:{offset:5,span:16},children:Object(v.jsx)(y.a,{type:"primary",htmlType:"submit",children:"\u767b\u5165"})})]})}var w=n(236),k=n(241),I=n(240);function S(){var e=Object(s.useContext)(h),t=e.user,n=e.setUser,a=Object(o.h)(),c=Object(o.g)(),l=w.a.Header,b=Object(s.useState)(!1),d=Object(r.a)(b,2),u=d[0],m=d[1],O=window.innerWidth<=1194;return Object(v.jsxs)(l,{className:"fixed w-100 z-5",children:[Object(v.jsxs)(k.a,{theme:"dark",mode:"horizontal",defaultSelectedKeys:[function(){var e=a.pathname;return console.log(e),0===e.indexOf("/list")?"list":0===e.indexOf("/about")?"about":0===e.indexOf("/addPost")?"addPost":"/"}()],children:[Object(v.jsx)(k.a.Item,{children:Object(v.jsx)(i.b,{to:"/",children:"\u9996\u9801"})},"/"),Object(v.jsx)(k.a.Item,{children:Object(v.jsx)(i.b,{to:"/list",children:"\u6587\u7ae0\u5217\u8868"})},"list"),Object(v.jsx)(k.a.Item,{children:Object(v.jsx)(i.b,{to:"/about",children:"\u95dc\u65bc\u6211"})},"about"),Object(v.jsx)(k.a.Item,{children:Object(v.jsx)(i.b,{to:"/addPost",children:"\u65b0\u589e\u6587\u7ae0"})},"addPost")]}),Object(v.jsxs)("div",{className:"absolute white flex-l dn items-center",style:{right:"32px",top:0,height:"64px",position:"absolute"},children:[!O&&!t&&Object(v.jsx)(y.a,{type:"primary",onClick:function(){m(!0)},children:"\u767b\u5165"}),!O&&!t&&Object(v.jsx)(y.a,{type:"primary",style:{marginLeft:"20px"},children:Object(v.jsx)(i.b,{to:"/register",children:"\u8a3b\u518a"})}),!O&&t&&Object(v.jsx)(y.a,{type:"primary",onClick:function(){j(""),n(null),"/"!==a.pathname&&c.push("/")},children:"\u767b\u51fa"})]}),Object(v.jsx)(I.a,{title:"\u5e33\u865f\u767b\u5165",visible:u,onCancel:function(){m(!1)},footer:null,children:Object(v.jsx)(C,{handleOk:function(){m(!1)}})})]})}var P=n.p+"static/media/lidemy_logo.bd629eee.png";function N(){return Object(v.jsxs)("div",{className:"site-layout-background",style:{padding:24,minHeight:859,margin:"16px 0"},children:[Object(v.jsx)("h2",{style:{textAlign:"center",width:"70vw",margin:"16px auto"},children:"\u9019\u662f\u4e00\u500b\u6a21\u4eff Lidemy \u7a0b\u5f0f\u5c0e\u5e2b\u8a08\u756b\u5b78\u7fd2\u7cfb\u7d71\u7684\u90e8\u843d\u683c"}),Object(v.jsx)("div",{style:{textAlign:"center",margin:"70px auto"},children:Object(v.jsx)("img",{style:{width:"30vw"},alt:"Background",src:P})})]})}var q=n(237);function L(){var e=Object(s.useState)(""),t=Object(r.a)(e,2),n=t[0],a=t[1],c=Object(s.useState)(0),o=Object(r.a)(c,2),l=o[0],j=o[1],b=Object(s.useState)(1),u=Object(r.a)(b,2),h=u[0],p=u[1],x=Object(s.useContext)(m).setIsLoading,g=Object(s.useContext)(O).setPost;Object(s.useEffect)((function(){x(!0),function(e){return fetch("".concat(d,"/posts?_sort=createdAt&_order=desc&_page=").concat(e,"&_limit=5"))}(h).then((function(e){return j(e.headers.get("x-total-count")),e.json()})).then((function(e){a(e),x(!1)}))}),[h,a]);return Object(v.jsx)("div",{className:"site-layout-background",style:{padding:24,minHeight:859,margin:"16px 0"},children:Object(v.jsx)(q.b,{itemLayout:"horizontal",dataSource:n,size:"large",pagination:{pageSize:5,defaultCurrent:1,total:l,showSizeChanger:!1,onChange:function(e){p(e)}},renderItem:function(e){return Object(v.jsx)(q.b.Item,{children:Object(v.jsx)(q.b.Item.Meta,{title:Object(v.jsx)(i.b,{to:{pathname:"/post/".concat(e.id)},onClick:(t=e.title,n=e.body,function(){g({title:t,body:n})}),children:e.title})})});var t,n}})})}function z(){return Object(v.jsx)("div",{className:"site-layout-background",style:{padding:24,minHeight:859,margin:"16px 0"},children:Object(v.jsx)("div",{style:{padding:24,margin:"16px auto"},children:Object(v.jsx)("h2",{children:"\u55e8\u55e8\uff0c\u6211\u662f Jason\uff0c\u56e0\u7de3\u969b\u6703\u4e0b\u8e0f\u5165\u7a0b\u5f0f\u7684\u9818\u57df\uff0c\u559c\u6b61\u5b78\u7fd2\u65b0\u6280\u8853\uff0c\u76ee\u524d\u525b\u5f9eLidemy \u7a0b\u5f0f\u5c0e\u5e2b\u5be6\u9a57\u8a08\u756b\u7b2c\u4e94\u671f\u7d50\u696d\uff0c\u5e0c\u671b\u672a\u4f86\u80fd Web \u7684\u9818\u57df\u6301\u7e8c\u947d\u7814\u3001\u7df4\u7fd2\uff0c\u958b\u767c\u51fa\u81ea\u5df1\u3001\u4f7f\u7528\u8005\u90fd\u559c\u611b\u7684\u7db2\u9801\u3002 \u9019\u662f\u4e00\u500b\u662f\u7528 Ant Design \u70ba UI Library \u914d\u5408 React \u958b\u767c\u7684\u90e8\u843d\u683c\u7db2\u9801\u914d\u5408\u5f8c\u6bb5\u4f7f\u7528 JWT \u5b8c\u6210\u767b\u5165\u9a57\u8b49\u6a5f\u5236\u7684\u7c21\u6613\u90e8\u843d\u683c~~"})})})}var _=n(47),T={labelCol:{span:7},wrapperCol:{span:12}},A={required:"${label} is required!"};function F(){var e=Object(s.useContext)(m).setIsLoading,t=Object(s.useContext)(h).user,n=Object(o.g)();return Object(v.jsx)("div",{className:"site-layout-background",style:{padding:24,minHeight:859,margin:"16px 0"},children:t?Object(v.jsxs)(x.a,Object(_.a)(Object(_.a)({},T),{},{name:"nest-messages",onFinish:function(t){var s=t.post,a=s.title,c=s.content;console.log(a,c),e(!0),function(e,t){var n=b();return fetch("".concat(d,"/posts"),{method:"POST",headers:{"content-type":"application/json",authorization:"Bearer ".concat(n)},body:JSON.stringify({title:e,body:t})}).then((function(e){return e.json()})).catch((function(e){return e}))}(a,c).then((function(t){if(2===t.code)return n.push("/"),e(!1),p.b.error("\u8acb\u5148\u767b\u5165");n.push("/list"),p.b.success("\u65b0\u589e\u6210\u529f"),e(!1)})).catch((function(){return e(!1),p.b.error("\u65b0\u589e\u5931\u6557")}))},validateMessages:A,children:[Object(v.jsx)(x.a.Item,{name:["post","title"],label:"\u6587\u7ae0\u6a19\u984c",rules:[{required:!0,message:"\u8acb\u8f38\u5165\u6587\u7ae0\u6a19\u984c"}],children:Object(v.jsx)(g.a,{})}),Object(v.jsx)(x.a.Item,{name:["post","content"],label:"\u6587\u7ae0\u5167\u5bb9",rules:[{required:!0,message:"\u8acb\u8f38\u5165\u6587\u7ae0\u5167\u5bb9"}],children:Object(v.jsx)(g.a.TextArea,{})}),Object(v.jsx)(x.a.Item,{wrapperCol:Object(_.a)(Object(_.a)({},T.wrapperCol),{},{offset:12}),children:Object(v.jsx)(y.a,{type:"primary",htmlType:"submit",children:"Submit"})})]})):"\u5148\u53bb\u767b\u5165\u5594"})}function H(){var e=Object(s.useContext)(O).post,t=Object(o.g)();return Object(s.useEffect)((function(){null===e&&t.push("/")}),[]),Object(v.jsx)("div",{className:"site-layout-background",style:{padding:24,minHeight:859,margin:"16px 0"},children:e&&Object(v.jsx)("div",{className:"posts",children:Object(v.jsxs)("article",{className:"post",children:[Object(v.jsx)("div",{className:"post__header",children:Object(v.jsx)("h1",{children:e.title})}),Object(v.jsx)("div",{className:"post__content",children:e.body})]})})})}var J={labelCol:{span:7},wrapperCol:{span:12}},U={required:"${label} is required!"};function B(){var e=Object(s.useContext)(m).setIsLoading,t=Object(s.useContext)(h).setUser,n=Object(o.g)();return Object(v.jsx)("div",{className:"site-layout-background",style:{padding:24,minHeight:859,margin:"16px 0"},children:Object(v.jsxs)(x.a,Object(_.a)(Object(_.a)({},J),{},{name:"nest-messages",onFinish:function(s){var a=s.user,c=a.username,r=a.password,i=a.nickname;e(!0),function(e,t,n){return fetch("".concat(d,"/register"),{method:"POST",headers:{"content-type":"application/json"},body:JSON.stringify({nickname:n,username:e,password:t})}).then((function(e){return e.json()}))}(c,r,i).then((function(s){if(1!==s.ok)return e(!1),p.b.error("\u6b64\u5e33\u865f\u5df2\u6709\u4eba\u4f7f\u7528");j(s.token),u().then((function(s){t(s.data),n.push("/"),p.b.success("\u8a3b\u518a\u6210\u529f"),e(!1)}))}))},validateMessages:U,children:[Object(v.jsx)(x.a.Item,{name:["user","username"],label:"username",rules:[{required:!0}],children:Object(v.jsx)(g.a,{})}),Object(v.jsx)(x.a.Item,{name:["user","password"],label:"password",rules:[{required:!0},{min:4,message:"\u5fc5\u9808\u70ba4\u4f4d\u4ee5\u4e0a"},{max:12,message:"\u5fc5\u9808\u70ba12\u4f4d\u4ee5\u4e0b"},{pattern:/^[a-zA-Z0-9_]+$/,message:"\u4e0d\u80fd\u6709\u82f1\u6578\u5b57\u8207\u4e0b\u6ed1\u7dda\u5916\u4e4b\u5b57\u7b26"}],children:Object(v.jsx)(g.a.Password,{})}),Object(v.jsx)(x.a.Item,{name:["user","nickname"],label:"nickname",rules:[{required:!0}],children:Object(v.jsx)(g.a,{})}),Object(v.jsx)(x.a.Item,{wrapperCol:Object(_.a)(Object(_.a)({},J.wrapperCol),{},{offset:12}),children:Object(v.jsx)(y.a,{type:"primary",htmlType:"submit",children:"Submit"})})]}))})}var E=n(138);function M(){return Object(v.jsx)("div",{className:"fixed flex items-center justify-center",style:{top:0,left:0,right:0,bottom:0,zIndex:999999,background:"rgba(0, 0, 0, 0.25)",position:"absolute",textAlign:"center",lineHeight:"800px"},children:Object(v.jsx)(E.a,{})})}var W=function(){var e=w.a.Content,t=w.a.Footer,n=Object(s.useState)(null),a=Object(r.a)(n,2),c=a[0],l=a[1],j=Object(s.useState)(!1),d=Object(r.a)(j,2),p=d[0],x=d[1],g=Object(s.useState)(null),f=Object(r.a)(g,2),y=f[0],C=f[1];return Object(s.useEffect)((function(){b()&&u().then((function(e){e.ok&&l(e.data)})).catch((function(e){console.log(e)}))}),[]),Object(v.jsxs)(h.Provider,{value:{user:c,setUser:l},children:[p&&Object(v.jsx)(M,{}),Object(v.jsx)(m.Provider,{value:{isLoading:p,setIsLoading:x},children:Object(v.jsx)(O.Provider,{value:{post:y,setPost:C},children:Object(v.jsx)(i.a,{children:Object(v.jsxs)(w.a,{children:[Object(v.jsx)(S,{}),Object(v.jsx)(e,{className:"site-layout",style:{padding:"0 50px",marginTop:64},children:Object(v.jsxs)(o.d,{children:[Object(v.jsx)(o.b,{exact:!0,path:"/",component:N}),Object(v.jsx)(o.b,{path:"/list",component:L}),Object(v.jsx)(o.b,{path:"/addPost",component:F}),Object(v.jsx)(o.b,{path:"/about",component:z}),Object(v.jsx)(o.b,{path:"/register",component:B}),Object(v.jsx)(o.b,{path:"/post/:id",component:H}),Object(v.jsx)(o.a,{to:"/",component:N})]})}),Object(v.jsxs)(t,{style:{textAlign:"center"},children:["Made with ",Object(v.jsx)("span",{style:{color:"red"},children:"\u2665"})," by Jason"]})]})})})})]})};c.a.render(Object(v.jsx)(v.Fragment,{children:Object(v.jsx)(W,{})}),document.getElementById("root"))}},[[234,1,2]]]);
//# sourceMappingURL=main.57496e28.chunk.js.map