(this.webpackJsonpblog=this.webpackJsonpblog||[]).push([[0],{153:function(e,t,n){},154:function(e,t,n){},234:function(e,t,n){"use strict";n.r(t);var s=n(0),a=n.n(s),c=n(24),r=n.n(c),i=(n(153),n(45)),o=(n(154),n(30)),l=n(23),j="token",u=function(e){localStorage.setItem(j,e)},b=function(){return localStorage.getItem(j)},d="https://student-json-api.lidemy.me",h=function(){var e=b();return fetch("".concat(d,"/me"),{headers:{authorization:"Bearer ".concat(e)}}).then((function(e){return e.json()}))},m=Object(s.createContext)(null),p=Object(s.createContext)(null),O=Object(s.createContext)(null),x=n(143),f=n(238),g=n(239),y=n(242),v=n(60),C=n(7);function k(e){var t=Object(s.useContext)(m).setUser,n=Object(s.useContext)(p).setIsLoading,a=e.handleOk,c=Object(l.g)();return Object(C.jsxs)(f.a,{name:"basic",labelCol:{span:5},wrapperCol:{span:16},initialValues:{remember:!0},onFinish:function(e){var s=e.username,r=e.password;n(!0),function(e,t){return fetch("".concat(d,"/login"),{method:"POST",headers:{"content-type":"application/json"},body:JSON.stringify({username:e,password:t})}).then((function(e){return e.json()}))}(s,r).then((function(e){if(0===e.ok)return x.b.error("\u5e33\u865f\u5bc6\u78bc\u932f\u8aa4");u(e.token),h().then((function(e){1!==e.ok&&u(null),t(e.data),a(),c.push("/"),x.b.success("\u767b\u5165\u6210\u529f"),n(!1)}))}))},onFinishFailed:function(e){console.log("Failed:",e)},children:[Object(C.jsx)(f.a.Item,{label:"Username",name:"username",rules:[{required:!0,message:"Please input your username!"}],children:Object(C.jsx)(g.a,{})}),Object(C.jsx)(f.a.Item,{label:"Password",name:"password",rules:[{required:!0,message:"Please input your password!"}],children:Object(C.jsx)(g.a.Password,{})}),Object(C.jsx)(f.a.Item,{name:"remember",valuePropName:"checked",wrapperCol:{offset:5,span:16},children:Object(C.jsx)(y.a,{children:"Remember me"})}),Object(C.jsx)(f.a.Item,{wrapperCol:{offset:5,span:16},children:Object(C.jsx)(v.a,{type:"primary",htmlType:"submit",children:"\u767b\u5165"})})]})}var I=n(236),w=n(241),S=n(240);function N(){var e=Object(s.useContext)(m),t=e.user,n=e.setUser,a=Object(l.h)(),c=Object(l.g)(),r=I.a.Header,j=Object(s.useState)(!1),b=Object(i.a)(j,2),d=b[0],h=b[1];return Object(C.jsxs)(r,{className:"fixed w-100 z-5",children:[Object(C.jsxs)(w.a,{theme:"dark",mode:"horizontal",defaultSelectedKeys:["1"],children:[Object(C.jsx)(w.a.Item,{children:Object(C.jsx)(o.b,{to:"/",children:"\u9996\u9801"})},"/"),Object(C.jsx)(w.a.Item,{children:Object(C.jsx)(o.b,{to:"/list",children:"\u6587\u7ae0\u5217\u8868"})},"/list"),Object(C.jsx)(w.a.Item,{children:Object(C.jsx)(o.b,{to:"/about",children:"\u95dc\u65bc\u6211"})},"/about"),Object(C.jsx)(w.a.Item,{children:Object(C.jsx)(o.b,{to:"/addPost",children:"\u65b0\u589e\u6587\u7ae0"})},"/addPost")]}),Object(C.jsxs)("div",{className:"absolute white flex-l dn items-center",style:{right:"32px",top:0,height:"64px",position:"absolute"},children:[!t&&Object(C.jsx)(v.a,{type:"primary",onClick:function(){h(!0)},children:"\u767b\u5165"}),!t&&Object(C.jsx)(v.a,{type:"primary",style:{marginLeft:"20px"},children:Object(C.jsx)(o.b,{to:"/register",children:"\u8a3b\u518a"})}),t&&Object(C.jsx)(v.a,{type:"primary",onClick:function(){u(""),n(null),"/"!==a.pathname&&c.push("/")},children:"\u767b\u51fa"})]}),Object(C.jsx)(S.a,{title:"\u5e33\u865f\u767b\u5165",visible:d,onCancel:function(){h(!1)},footer:null,children:Object(C.jsx)(k,{handleOk:function(){h(!1)}})})]})}function P(){return Object(C.jsx)("div",{className:"site-layout-background",style:{padding:24,minHeight:830,margin:"16px 0"},children:"Content"})}var q=n(237);function z(){var e=Object(s.useState)(""),t=Object(i.a)(e,2),n=t[0],a=t[1],c=Object(s.useState)(0),r=Object(i.a)(c,2),l=r[0],j=r[1],u=Object(s.useState)(1),b=Object(i.a)(u,2),h=b[0],m=b[1],x=Object(s.useContext)(p).setIsLoading,f=Object(s.useContext)(O).setPost;Object(s.useEffect)((function(){x(!0),function(e){return fetch("".concat(d,"/posts?_sort=createdAt&_order=desc&_page=").concat(e,"&_limit=5"))}(h).then((function(e){return j(e.headers.get("x-total-count")),e.json()})).then((function(e){a(e),console.log(e),x(!1)}))}),[h,a]);return Object(C.jsx)("div",{className:"site-layout-background",style:{padding:24,minHeight:830,margin:"16px 0"},children:Object(C.jsx)(q.b,{itemLayout:"horizontal",dataSource:n,size:"large",pagination:{pageSize:5,defaultCurrent:1,total:l,showSizeChanger:!1,onChange:function(e){m(e)}},renderItem:function(e){return Object(C.jsx)(q.b.Item,{children:Object(C.jsx)(q.b.Item.Meta,{title:Object(C.jsx)(o.b,{to:{pathname:"/post/".concat(e.id)},onClick:(t=e.title,n=e.body,function(){f({title:t,body:n})}),children:e.title})})});var t,n}})})}function _(){return Object(C.jsx)("div",{className:"site-layout-background",style:{padding:24,minHeight:830,margin:"16px 0"},children:"\u54c8\u54c8\uff0c\u6211\u662f Jason \u5566"})}var F=n(47),H={labelCol:{span:7},wrapperCol:{span:12}},L={required:"${label} is required!"};function T(){var e=Object(s.useContext)(p).setIsLoading,t=Object(s.useContext)(m),n=t.user,a=(t.setUser,Object(l.g)());return Object(C.jsx)("div",{className:"site-layout-background",style:{padding:24,minHeight:830,margin:"16px 0"},children:n&&Object(C.jsxs)(f.a,Object(F.a)(Object(F.a)({},H),{},{name:"nest-messages",onFinish:function(t){var n=t.post,s=n.title,c=n.content;console.log(s,c),e(!0),function(e,t){var n=b();return fetch("".concat(d,"/posts"),{method:"POST",headers:{"content-type":"application/json",authorization:"Bearer ".concat(n)},body:JSON.stringify({title:e,body:t})}).then((function(e){return e.json()})).catch((function(e){return e}))}(s,c).then((function(t){if(2===t.code)return a.push("/"),e(!1),x.b.error("\u8acb\u5148\u767b\u5165");a.push("/list"),x.b.success("\u65b0\u589e\u6210\u529f"),e(!1)})).catch((function(){return e(!1),x.b.error("\u65b0\u589e\u5931\u6557")}))},validateMessages:L,children:[Object(C.jsx)(f.a.Item,{name:["post","title"],label:"\u6587\u7ae0\u6a19\u984c",rules:[{required:!0,message:"\u8acb\u8f38\u5165\u6587\u7ae0\u6a19\u984c"}],children:Object(C.jsx)(g.a,{})}),Object(C.jsx)(f.a.Item,{name:["post","content"],label:"\u6587\u7ae0\u5167\u5bb9",rules:[{required:!0,message:"\u8acb\u8f38\u5165\u6587\u7ae0\u5167\u5bb9"}],children:Object(C.jsx)(g.a.TextArea,{})}),Object(C.jsx)(f.a.Item,{wrapperCol:Object(F.a)(Object(F.a)({},H.wrapperCol),{},{offset:12}),children:Object(C.jsx)(v.a,{type:"primary",htmlType:"submit",children:"Submit"})})]}))})}function J(){var e=Object(s.useContext)(O).post,t=Object(l.g)();return Object(s.useEffect)((function(){null===e&&t.push("/")}),[]),Object(C.jsx)("div",{className:"site-layout-background",style:{padding:24,minHeight:830,margin:"16px 0"},children:e&&Object(C.jsx)("div",{className:"posts",children:Object(C.jsxs)("article",{className:"post",children:[Object(C.jsx)("div",{className:"post__header",children:Object(C.jsx)("h1",{children:e.title})}),Object(C.jsx)("div",{className:"post__content",children:e.body})]})})})}var U={labelCol:{span:7},wrapperCol:{span:12}},A={required:"${label} is required!"};function E(){var e=Object(s.useContext)(p).setIsLoading,t=Object(s.useContext)(m).setUser,n=Object(l.g)();return Object(C.jsx)("div",{className:"site-layout-background",style:{padding:24,minHeight:830,margin:"16px 0"},children:Object(C.jsxs)(f.a,Object(F.a)(Object(F.a)({},U),{},{name:"nest-messages",onFinish:function(s){var a=s.user,c=a.username,r=a.password,i=a.nickname;e(!0),function(e,t,n){return fetch("".concat(d,"/register"),{method:"POST",headers:{"content-type":"application/json"},body:JSON.stringify({nickname:n,username:e,password:t})}).then((function(e){return e.json()}))}(c,r,i).then((function(s){if(1!==s.ok)return e(!1),x.b.error("\u6b64\u5e33\u865f\u5df2\u6709\u4eba\u4f7f\u7528");u(s.token),h().then((function(s){t(s.data),n.push("/"),x.b.success("\u8a3b\u518a\u6210\u529f"),e(!1)}))}))},validateMessages:A,children:[Object(C.jsx)(f.a.Item,{name:["user","username"],label:"username",rules:[{required:!0}],children:Object(C.jsx)(g.a,{})}),Object(C.jsx)(f.a.Item,{name:["user","password"],label:"password",rules:[{required:!0},{min:4,message:"\u5fc5\u9808\u70ba4\u4f4d\u4ee5\u4e0a"},{max:12,message:"\u5fc5\u9808\u70ba12\u4f4d\u4ee5\u4e0b"},{pattern:/^[a-zA-Z0-9_]+$/,message:"\u4e0d\u80fd\u6709\u82f1\u6578\u5b57\u8207\u4e0b\u6ed1\u7dda\u5916\u4e4b\u5b57\u7b26"}],children:Object(C.jsx)(g.a.Password,{})}),Object(C.jsx)(f.a.Item,{name:["user","nickname"],label:"nickname",rules:[{required:!0}],children:Object(C.jsx)(g.a,{})}),Object(C.jsx)(f.a.Item,{wrapperCol:Object(F.a)(Object(F.a)({},U.wrapperCol),{},{offset:12}),children:Object(C.jsx)(v.a,{type:"primary",htmlType:"submit",children:"Submit"})})]}))})}var M=n(138);function B(){return Object(C.jsx)("div",{className:"fixed flex items-center justify-center",style:{top:0,left:0,right:0,bottom:0,zIndex:999999,background:"rgba(0, 0, 0, 0.25)",position:"absolute",textAlign:"center",lineHeight:"800px"},children:Object(C.jsx)(M.a,{})})}var $=function(){var e=a.a.useState,t=a.a.useEffect,n=I.a.Content,s=I.a.Footer,c=e(null),r=Object(i.a)(c,2),j=r[0],u=r[1],b=e(!1),d=Object(i.a)(b,2),x=d[0],f=d[1],g=e(null),y=Object(i.a)(g,2),v=y[0],k=y[1];return t((function(){h().then((function(e){e.ok&&u(e.data)}))}),[]),Object(C.jsxs)(m.Provider,{value:{user:j,setUser:u},children:[x&&Object(C.jsx)(B,{}),Object(C.jsx)(p.Provider,{value:{isLoading:x,setIsLoading:f},children:Object(C.jsx)(O.Provider,{value:{post:v,setPost:k},children:Object(C.jsx)(o.a,{children:Object(C.jsxs)(I.a,{children:[Object(C.jsx)(N,{}),Object(C.jsx)(n,{className:"site-layout",style:{padding:"0 50px",marginTop:64},children:Object(C.jsxs)(l.d,{children:[Object(C.jsx)(l.b,{exact:!0,path:"/",component:P}),Object(C.jsx)(l.b,{path:"/list",component:z}),Object(C.jsx)(l.b,{path:"/addPost",component:T}),Object(C.jsx)(l.b,{path:"/about",component:_}),Object(C.jsx)(l.b,{path:"/register",component:E}),Object(C.jsx)(l.b,{path:"/post/:id",component:J}),Object(C.jsx)(l.a,{to:"/",component:P})]})}),Object(C.jsx)(s,{style:{textAlign:"center"},children:"Made with \u2665 by Jason"})]})})})})]})};r.a.render(Object(C.jsx)(C.Fragment,{children:Object(C.jsx)($,{})}),document.getElementById("root"))}},[[234,1,2]]]);
//# sourceMappingURL=main.707cc503.chunk.js.map